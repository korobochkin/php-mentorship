# PHP Mentorship. Part 4
Самое важное из четвертого занятия по PHP после длительного перерыва. Занятие проходило в среду, 2 сентября 2015.

Арсений рассказывал про протокол HTTP и его особенности. В конце мы чуть-чуть коснулись темы веб-сокетов, второй версии протокола (HTTP2) и Amqp.

## Протокол HTTP

[Документация](http://www.w3.org/Protocols/), традиционно на W3C. Также [иллюстрированная вводная статья]( http://symfony.com/doc/current/book/http_fundamentals.html), подробно раскрывающая все аспекты, в документации по Symofony2 (ее обязательно нужно прочитать).

В целом, стоит знать и помнить, что в протоколе предусмотрены несколько методов, хотя все, в основном, помнят лишь парочку — GET и POST (в большинстве случаев лишь они и используются). Остальные в документации :)

Пример простого запроса:

```
GET /path/file.html HTTP/1.1
Host: github.com:80
[blank line here]
```

Выполнить запрос можно с помощью [cURL](http://curl.haxx.se/docs/manpage.html) — консольная утилита, которая позволяет взимодействовать с сетью.

В ответе указывается код состояния и, собственно, ответ. В данном случае ответ с кодом 200 и заголовками Date и Server:

```
HTTP/1.1 200 OK
Date: Wed, 11 Feb 2009 11:20:59 GMT
Server: Apache
```

В примере выше всего лишь два заголовка, но на самом деле их [очень много разных](https://en.wikipedia.org/wiki/List_of_HTTP_header_fields). Есть даже не документированные в спецификации, но все равно необходимые.

После заголовков через одну пустую строчку идет, собственно, само тело страницы (ответа).

### Идемпотентность. Идемпотентые запросы

Существует термин «[идемпотентность](https://ru.wikipedia.org/wiki/Идемпотентность)». Расшифровка — если к чему-то (объекту, ресурсу) применять какую-либо операцию (метод), то результат всегда будет одинаков. Вне зависимости от количества повторов. Например, метод `GET` идемпотентен, т. к. его вызов не приводит к изменению ресурса — в результате мы всегда получаем одинаковый ответ от сервера (хотя, конечно, количество просмотров статьи и другие не совсем значительные данные могут изменяться). Метод `DELETE`, по идее, тоже идемпотентен, однако, как правило, ответы от сервера будут разными — первый раз мы действительно удаляем материал (ресурс). Во все последующие случаи сервер будет отвечать `404`, т. к. необходимый ресурс не найден (уже удален).

Вот и все!

## AMQP

Еще один протокол ([AMQP в Википедии](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol])), который можно использовать, если что-то нужно ставить в очереди. Например, может применяться, если на сайте есть функционал генерации документов по запросу — ставим в очередь и сообщаем пользователю об их готовности.

## Веб-сокеты

Нужны если нужно поддерживать двухсторонню неприрывную связь между клиентом и сервером. Пригодится для систем оповещений или чатиков. Для PHP есть как минимум [Ratchet](http://socketo.me).

## HTTP2

Он позволит нам, например, забыть о такой проблеме, как конкатенация файлов, потому что в браузер вся сотня JS и CSS файликов будет отдаваться единой "посылкой".

## Бонус

Также Арсений упомянул про [CORS] (https://en.wikipedia.org/wiki/Cross-origin_resource_sharing). В двух словах — это когда с помощью Java Script можно что-нибудь украсть. Примерчик есть в ссылке на строчку выше.
