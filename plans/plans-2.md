# PHP Mentorship. Part 2

Планируем что поделать на втором занятии по PHP.

## Про WordPress

Насколько правильно и клево написан код [WordPress Plugin Boilerplate](https://github.com/DevinVinson/WordPress-Plugin-Boilerplate/tree/master/plugin-name)?

Например, в файле [`class-plugin-name-loader.php`](https://github.com/DevinVinson/WordPress-Plugin-Boilerplate/blob/master/plugin-name/includes/class-plugin-name-loader.php) видно, что сначала описываются просто переменные, а в методе `__contruct()` они заполняются данными.

Также в [`class-plugin-name.php#L151`](https://github.com/DevinVinson/WordPress-Plugin-Boilerplate/blob/master/plugin-name/includes/class-plugin-name.php#L151) версия и название плагина передается в другой класс, где они сохраняются еще раз - мне кажется это не надо делать или могут быть причины для такой конструкции?

## Аудит

Пара моих простейших плагинов — [bbPress Permalinks with ID](https://github.com/korobochkin/bbpress-permalinks-with-id/blob/master/plugin/plugin.php) и [Mark User as Spammer](https://github.com/korobochkin/mark-user-as-spammer/blob/master/plugin/plugin.php). Качество кода, стилистика, может быть есть грубые ошибки или что-то в этом роде?

Начал делать [плагин-адаптацию сервиса Recaptcha](https://github.com/korobochkin/reCAPTCHA-lightweight-adaptation/tree/release/v1.0.0/plugin) от Google и застрял. Кучу классов сделал, пытаясь раскидать по ним функционал, но, похоже, сам и запутался. Вопрос: насколько адекватно я стал раскидывать функционал и как вообще правильно разбить вот такое маленькое «приложение» на базовые составляющие (подробнее см. дальше).

### Что должен делать плагин reCAPTCHA Lightweight Adaptation?
Плагин реализует использование сервиса [Recaptcha от Google](https://www.google.com/recaptcha/) (блок с картинкой, для защиты от спама). Составляющие части плагина:
  1. Страница настроек ([«схема» того](http://cl.ly/Z3tp/o), что из себя представляют настройки в WordPress).
  2. Класс с методами для взаимодействия с API Google.
  3. Класс для вывода формочки капчи в любом месте сайта.
  4. Класс, который по умолчанию прикручивает все выше описанное для формы регистрации в WordPress.

## Конструтор

Что значит вот такая конструкция ([оригинал](http://designpatternsphp-ru.readthedocs.org/ru/latest/Structural/Bridge/README.html))? Какие-то хитрые аргументы передаются.
```
public function __construct(Workshop $workShop1, Workshop $workShop2) {
  parent::__construct($workShop1, $workShop2);
}
```

## Прочие вопросы

Что такое `namespaces`? Стоит ли их использовать и как?

Как удалять классы? Просто удалить класс я так понимаю нельзя, но экземпляр класса? `unset()`, видимо, не то, что надо. А если удалять переменную, в которую «клалось» нечто `new ClassName`, то мы удаляем лишь указатель.

На сайте Симфонии написано, что Джумла написана на этом фреймворке. Как это понимать? :)

На чем запускать проекты локально? Есть ли какие-то заготовки для Vagrant (эта же тема затрагивается ниже)?

## Чем заняться на занятии?
Взять любой фреймворк и сделать на нем простенький сайтик на одну-две страницы. В процессе должны увидеть и столкнуться:
  1. Как красиво и «правильно» начинать репозиторий (я, в принципе, это умею делать, но хочется посмотреть как делать «правильно», может о чем-то не знаю или что-то делаю не правильно, не видел как кто-то другой пользовался репозиториями).
  2. Запустим Vagrant или что-то другое. Наверняка есть готовые образы для разработки на разных фреймворках, чтобы не тратить полнедели на настройку веб-сервера. Например, для WordPress есть [VVV](https://github.com/Varying-Vagrant-Vagrants/VVV) с огромным списком предустановленного софта необходимого для разработки под WP.
  3. Не будем скачивать zip-чики, а с помощью Composer сложим мозайку.
  4. Сделаем простую страничку, на которой можно оставить свой адрес эл. почты. И здесь мы столкнемся с некоторыми интересными вещами, которые доставляют много боли, если делать это с помощью «flat php» (без фреймворков и тупо функциями в лоб).
    1. Создание форм на страницах. А что если таких одинаковых форм надо 10 штук на странице? А если еще и AJAX прикрутить понадобится (у каждой формы должен быть свой `ID` или что-то такое)?
    2. Прикручиваение CSS-фреймворков к PHP-фрейморкам. Взять, к примеру, Boostrap и добавить к нашей формочке пару классов, чтобы красивее было.
    3. Прием данных на сервере и обработка.
    4. Вывод пользовательских данных. Фильтрация, XSS.
    5. Для упрощения урока результат (адрес эл. почты) можно записывать в файл на диске, если база данных это слишком.
    6. Обработка несуществующих страниц (404).
    7. Одновременное добавление данных в один файл (БД). Что-то нужно сделать, чтобы наше приложение не падало, если файла нет, если файл открыт и занят другим процессом (записывается адрес от другого посетителя сайта) и т. п.

Впервые [файл опубликован на gist.github](https://gist.github.com/korobochkin/71bdc4b54ec7f184abca).
